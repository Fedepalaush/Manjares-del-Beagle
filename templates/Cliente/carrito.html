{% extends 'Cliente/base.html'%}

{% block content %}
<h2 style="text-align: center;">Carrito</h2>
<hr style="height: 3px; background-color: black;" width="90%"/>

<div class="table-responsive" id="tableContainer">
    <table id="table" class="table table-striped table-bordered border-warning" style="max-width:100%">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Cantidad</th>
                <th>Precio</th>
                <th>Subtotal</th>
                <th>Gestión</th>
            </tr>
        </thead>
        <tbody>
                {% for datos in lista %}
                <tr>
                    <form action="/eliminarItem" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="alimento" value={{datos.alimentoID}}>
                        <td><b>{{datos.alimentoNombre}}</b></td>            
                        <td>{{datos.cantidad}}</td>
                        <td>${{datos.precio}}</td>            
                        <td>${{datos.subtotal}}</td>
                        <td><button class="btn btn-danger btn-flat" type="submit">Quitar</button></td>
                    </form>
                </tr>
                {% endfor %}
                <td>Total: ${{total}}</td>
            </tbody>
    </table>
</div>
<br>
<br>
<a href="{% url 'indexCliente' %}" class="btn btn-primary btn-lg active" role="button" aria-pressed="true">Seguir comprando</a>
<a class="btn btn-primary btn-lg active" role="button" aria-pressed="true" 
style="position: absolute; right: 0;" onclick="vaciarCarrito()">Vaciar carrito</a>

<h2 style="text-align: center;">Datos Personales</h2>
<hr style="height: 3px; background-color: black;" width="90%"/>

<br>
<form action="/confirmarPedido" method="post">  
    {% csrf_token %}
    <label for="nombreApellido">Ingresar nombre: </label>
    <input id="nombreApellido" type="text" name="nombreApellido">

    <label for="celular">Celular: </label>
    <input id="celular" type="text" name="celular">

    <label for="descripcion">Descripcion: </label>
    <input id="descripcion" type="text" name="descripcion">

    <fieldset style="width: 400px; border:1px solid black">
        <legend class="w-auto">Entrega</legend>
        <input name="entrega" type="radio" value="enlocal" onclick="ocultarDireccion()" />En local. <br>
        <input name="entrega" type="radio" onclick="mostrarDireccion()" />En domicilio.
        <input id="direccion" type="text" name="direccion" size="50" placeholder="Ingrese su dirección..."
        autocomplete="on" runat="server" style="display: none" />
    </fieldset>

    <input id="latitud" type="hidden" name="latitud" ><br>
    <input id="longitud" type="hidden" name="longitud" ><br>

    <button type="submit" class="btn btn-primary btn-lg active" role="button" aria-pressed="true" style="position: absolute; right: 0;" onclick="obtenerDireccion()">Confirmar pedido</button>

</form>

    <script>
        function obtenerDireccion() {
            if (document.getElementById('direccion').value == "") {
                document.getElementById('direccion').value = "-";
                document.getElementById('latitud').value = "0";
                document.getElementById('longitud').value = "0";
            }
            if (document.getElementById('descripcion').value == ""){
                document.getElementById('descripcion').value = "-";
            }
        }
    </script>

<!-- BOTON PAGAR MERCADO PAGO -->

<form action="/carrito" method="POST">
    {% csrf_token %}
    <script
     src="https://www.mercadopago.com.ar/integrations/v1/web-payment-checkout.js"
     data-preference-id="{{preference_id}}">
    </script>
  </form>

<!-- FIN MERCADO PAGO -->

<script>
    function mostrarDireccion() {
        document.getElementById("direccion").style.display= "inline";
    }
    function ocultarDireccion() {
        document.getElementById("direccion").style.display= "none";
    }
</script>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC5bJ7e24SdcnhOtbqPMfC30MrOlhLyMTI&libraries=places"></script>
{% endblock %}